---
layout: post
title: Remapのマクロ機能を活用しましょう
categories:
- keyboard
---

皆さんはパソコンのキーボードをどれだけ活用していますでしょうか？「いや、普通に文字打ってるだけですけど！」という感想をお持ちの方も多いことでしょう。しかし、キーボードのファームウェアをカスタマイズできるキーボードが世の中には数多く販売されています。そして、 [Remap](https://remap-keys.app) というウェブアプリを使うことで、難しいファームウェアの再ビルドなどをすることなく、ウェブブラウザ上でキーボードを簡単にカスタマイズすることができます。


![]({{ "/images/2021/09/remap-macro-1.webp" | prepend: site.baseurl }})


Remap に対応したキーボードは、すでに 190 個を超えています。Remap 対応のキーボードカタログがありますので、ぜひご覧になってみてください。

[キーボードカタログ](https://remap-keys.app/catalog)


![]({{ "/images/2021/09/remap-macro-2.webp" | prepend: site.baseurl }})


さて、このエントリでは、Remapに最近搭載された非常に強力な機能である「マクロ」機能を紹介したいと思います。このマクロ機能は、市販されているほとんどのキーボードでは決して手に入らない「自作キーボードキット + Remap」ならではの機能です。

# マクロ機能とは

キーボードにあるキーを打鍵すると、普通は「何らかの文字」が一つ入力されます。当たり前ですね。そして、自作キーボードをすでにお使いの方であれば、「Ctrl + Shift + A」といった修飾キーと文字の同時押しについても、あるキーに割り当てることができます。

これらの入力は、打鍵の結果として「ある一つのキーコード」が OS に送られることを意味しています。

マクロ機能は、一つのキーを打鍵した結果、複数のキーコードを一気に OS に送ることができる機能です。といっても、よくわからないですよね。実際にやってみましょう。

マクロ機能を利用することができるのは、M0 〜 M15 という名前のキーコードになります。これらは、Remap の FUNCTIONS カテゴリにあります。


![]({{ "/images/2021/09/remap-macro-3.webp" | prepend: site.baseurl }})


よく見ると、M0 〜M15 には、鉛筆アイコンがついています。ここでは、M1 を使ってみましょう。M1 の鉛筆アイコンをクリックすると、Macro Editor が表示されます。


![]({{ "/images/2021/09/remap-macro-4.webp" | prepend: site.baseurl }})


ここでは「Hello」という文字列を組み立てていきましょう。まず、「H」は、ASCII カテゴリにあるので、そこにある「H」をドラッグアンドドロップで Macro Editor の「Please drop a keycode here!」の領域に持っていきます。


![]({{ "/images/2021/09/remap-macro-5.webp" | prepend: site.baseurl }})


そして、残りの「ello」も同じようにドラッグアンドドロップで追加していきます。「ello」は、BASIC カテゴリから追加します。


![]({{ "/images/2021/09/remap-macro-6.webp" | prepend: site.baseurl }})


追加が終わったら、FLASH ボタンを押します。これにより、「Hello」というマクロが M1 キーに登録され、キーボードのマイコンに書き込まれました。BACK ボタンを押して、キーボードレイアウトに戻ります。

あとは、どこかのキーに M1 を割り当てます。


![]({{ "/images/2021/09/remap-macro-7.webp" | prepend: site.baseurl }})


以上でマクロ機能の準備が完了しました。何かテキストエディタを開いて、M1 を割り当てたキーを押してみます。


![]({{ "/images/2021/09/macro-1.gif" | prepend: site.baseurl }})


キーを一つ押しただけなのに、「Hello」と一気に入力されました。これが「マクロ機能」です。

# もっと複雑なマクロ定義

先程は単に複数の文字を一気に入力するマクロの定義でしたが、もっと複雑なマクロも組むことができます。例えば、以下を見てみてください。


![]({{ "/images/2021/09/remap-macro-9.webp" | prepend: site.baseurl }})


順に「まず Home を押して、次に Shift + End を押して...」と頭の中でシミュレーションしてみてください。このマクロの挙動は、「ある行と同じ内容の行を追加する」です。


![]({{ "/images/2021/09/macro-2.gif" | prepend: site.baseurl }})


これは、アプリがこういった「行の複製機能」を提供してくれていなければ、今までは実現が困難だったことかと思います。Remap に対応したキーボードであれば、マクロ機能によって、文字入力をする箇所であればどこでも、このマクロを使って行の複製ができるようになります。すごくないですか？

# まとめ

このエントリでは、マクロ機能という非常に強力な仕組みについて紹介しました。

このマクロ機能を使うためには、 [QMK Firmware](https://github.com/qmk/qmk_firmware) というオープンソースのファームウェアを採用したキーボードで、VIA という仕組みが有効になっているファームウェアが書き込まれた状態であれば、Remap からマクロを組んで書き込みを行い、利用することができます。

僕が設計し販売している Lunakey Mini というキーボードも、Remap によりマクロ機能を使えますので、もしご興味ある方はぜひ下記よりお求めください。

* [Kochi Keyboard - Lunakey Mini](https://kochikeyboard.stores.jp/items/605ab0a6baeb3a0ff29252a2)
* [遊舎工房 - Lunakey Mini](https://shop.yushakobo.jp/collections/keyboard-1/products/consign_lunakey-mini)
* [組み立て済 - BOOTH](https://booth.pm/ja/items/2530075)

